# ── JobManager image ─────────────────────────────────────────────────────────
FROM harbor.narvanventures.com/dockerhub/flink:1.17.2-scala_2.12

# Add the connectors we need (ClickHouse, Postgres‑CDC, generic JDBC)
RUN set -eux; \
    apt-get update && apt-get install -y wget && rm -rf /var/lib/apt/lists/* \
 \
 && wget -nv -O /opt/flink/lib/flink-sql-connector-clickhouse-1.17.1-8.jar \
      https://repo1.maven.org/maven2/name/nkonev/flink/flink-sql-connector-clickhouse/1.17.1-8/flink-sql-connector-clickhouse-1.17.1-8.jar \
 \
 && wget -nv -O /opt/flink/lib/flink-sql-connector-postgres-cdc-2.4.0.jar \
      https://repo1.maven.org/maven2/com/ververica/flink-sql-connector-postgres-cdc/2.4.0/flink-sql-connector-postgres-cdc-2.4.0.jar \
 \
 && wget -nv -O /opt/flink/lib/flink-connector-jdbc-3.1.2-1.17.jar \
      https://repo1.maven.org/maven2/org/apache/flink/flink-connector-jdbc/3.1.2-1.17/flink-connector-jdbc-3.1.2-1.17.jar \
 \
 && wget -nv -O /opt/flink/lib/clickhouse-jdbc-0.3.2.jar \
      https://repo1.maven.org/maven2/ru/yandex/clickhouse/clickhouse-jdbc/0.3.2/clickhouse-jdbc-0.3.2.jar

# No extra dialect JAR is required: the ClickHouse connector registers its own factory.
